{% extends 'logistics/base.twig' %}

{% block content %}
    <div class="flashmessage alert alert-error fade load_error">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('There was an error while loading the reservations.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-error fade remove_error">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('There was an error while deleting the reservations.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-success fade remove_success">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('The reservation was successfully removed.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-error fade add_error">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('There was an error while adding the reservation. Please refresh the page to verify.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-success fade add_success">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('The reservation was successfully added.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-error fade update_error">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('There was an error while updating the reservations.') }}
        </div>
    </div>

    <div class="flashmessage alert alert-success fade update_success">
        <a class="close">&times;</a>
        <div class="content">
            {{ translate('The reservation was successfully updated.') }}
        </div>
    </div>

    <div id="calendar"></div>

    <div id="reservationForm" class="hide">
        {% if has_access('logistics_index', 'add') %}
            {% import 'site/partials/form.twig' as forms %}
            {{ forms.renderForm(form) }}
        {% endif %}
    </div>
{% endblock %}

{% block content_script %}
    <script type="text/javascript">
        $(document).ready(function() {
            $('.flashmessage .close').click(function () {
                $(this).parent().removeClass('in');
            });
            $('#calendar').logisticsCalendar({
                fetchUrl: '{{ url('logistics_reservation_fetch') }}',
                moveUrl: '{{ url('logistics_index', {'action': 'move'}) }}',
                addUrl: '{{ url('logistics_index', {'action': 'add'}) }}',
                editUrl: '{{ url('logistics_index', {'action': 'edit'}) }}',
                deleteUrl: '{{ url('logistics_index', {'action': 'delete'}) }}',
                passengerTypeaheadUrl: '{{ url("common_admin_academic_typeahead", {}) }}',
                editable: {% if has_access('logistics_index', 'add') %}true{% else %}false {% endif %},
                deletable: {% if has_access('logistics_index', 'delete') %}true{% else %}false {% endif %},
                form: $('#reservationForm'),
                monthNames: [
                    '{{ translate('January') }}',
                    '{{ translate('February') }}',
                    '{{ translate('March') }}',
                    '{{ translate('April') }}',
                    '{{ translate('May') }}',
                    '{{ translate('June') }}',
                    '{{ translate('July') }}',
                    '{{ translate('August') }}',
                    '{{ translate('September') }}',
                    '{{ translate('October') }}',
                    '{{ translate('November') }}',
                    '{{ translate('December') }}'
                ],
                monthNamesShort: [
                    '{{ translate('Jan') }}',
                    '{{ translate('Feb') }}',
                    '{{ translate('Mar') }}',
                    '{{ translate('Apr') }}',
                    '{{ translate('May') }}',
                    '{{ translate('Jun') }}',
                    '{{ translate('Jul') }}',
                    '{{ translate('Aug') }}',
                    '{{ translate('Sep') }}',
                    '{{ translate('Oct') }}',
                    '{{ translate('Nov') }}',
                    '{{ translate('Dec') }}'
                ],
                dayNames: [
                    '{{ translate('Sunday') }}',
                    '{{ translate('Monday') }}',
                    '{{ translate('Tuesday') }}',
                    '{{ translate('Wednesday') }}',
                    '{{ translate('Thursday') }}',
                    '{{ translate('Friday') }}',
                    '{{ translate('Saturday') }}'
                ],
                dayNamesShort: [
                    '{{ translate('Sun') }}',
                    '{{ translate('Mon') }}',
                    '{{ translate('Tue') }}',
                    '{{ translate('Wed') }}',
                    '{{ translate('Thu') }}',
                    '{{ translate('Fri') }}',
                    '{{ translate('Sat') }}'
                ],
                buttonText: {
                    today:    '{{ translate('today') }}',
                    month:    '{{ translate('month') }}',
                    week:     '{{ translate('week') }}',
                    day:      '{{ translate('day') }}'
                },
                loadError: function () {
                    $('.flashmessage').removeClass('in');
                    $('.load_error').addClass('in');
                },
                removeError: function () {
                    $('.flashmessage').removeClass('in');
                    $('.remove_error').addClass('in');
                },
                removeSuccess: function () {
                    $('.flashmessage').removeClass('in');
                    $('.remove_success').addClass('in');
                },
                addError: function () {
                    $('.flashmessage').removeClass('in');
                    $('.add_error').addClass('in');
                },
                addSuccess: function () {
                    $('.flashmessage').removeClass('in');
                    $('.add_success').addClass('in');
                },
                updateError: function () {
                    $('.flashmessage').removeClass('in');
                    $('.update_error').addClass('in');
                },
                updateSuccess: function () {
                    $('.flashmessage').removeClass('in');
                    $('.update_success').addClass('in');
                },
                hideErrors: function () {
                    $('.flashmessage').removeClass('in');
                },
                tNewReservation: '{{ translate('New Reservation') }}',
                tStartDate: '{{ translate('Start Date') }}',
                tEndDate: '{{ translate('End Date') }}',
                tLoad: '{{ translate('Load') }}',
                tAdditionalInformation: '{{ translate('Additional Information') }}',
                tDriver: '{{ translate('Driver') }}',
                tPassenger: '{{ translate('Passenger') }}',
                tDelete: '{{ translate('Delete') }}',
                tEdit: '{{ translate('Edit') }}',
            });
        });
    </script>
{% endblock %}