<?= $this->partial('partials/article/navigation.phtml', array('currentAction' => 'edit')); ?>

<div id="flashmessenger">
	<? foreach($this->flashMessages as $message) { echo $message; } ?>
</div>

<div id="controller_action">
    <?= $this->form; ?>
</div>

<aside>
	<? if ($this->article->isInternal()): ?>
		<div class="sidebox">
	        <div class="title">Manage Files</div>
	       	<div class="content">
		    	<p>
		        	<i>Please hit the link below to manage the files of this article!</i>
		        </p>
		        <p>
		           	<a href="<?= $this->url(array('action' => 'managefiles')); ?>">&rarr; Manage files</a>
		        </p>
		    </div>
		</div>
	<? endif; ?>
	<div class="sidebox">
	    <div class="title">New Version</div>
	   	<div class="content">
	    	<p>
	        	<i>Please hit the link below to create a new version of this article!</i>
	        </p>
	        <p>
	           	<a href="<?= $this->url(array('action' => 'newversion')); ?>">&rarr; New version</a>
	        </p>
	    </div>
	</div>
</aside>

<script type="text/javascript">
	$(document).ready(function () {
		$('#internal').click(toggleInternal)
			.parent().parent().hide();
		$('#stock').click(toggleStock)
			.parent().parent().hide();
		toggleInternal();
		toggleStock();
	});
	
	function toggleInternal() {
		if ($('#internal').is(':checked'))
			$('#internal_form').show();
		else
			$('#internal_form').hide();
	}
	
	function toggleStock() {
		if ($('#stock').is(':checked')) {
			$('#stock_form').show();
			toggleInternal();
		} else {
			$('#stock_form, #internal_form').hide();
			$('#internal').removeAttr("checked");
		}
	}
</script>